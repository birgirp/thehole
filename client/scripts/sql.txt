
 
 v_scorecards_round2:

 SELECT s.id,
    u.full_name,
    c.course_name,
    c.id AS course_id,
    c.tee,
    s.handicap,
    s.tour_id,
    s.tour_round,
    s.round_date,
	   ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 1) AS h1,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 2) AS h2,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 3) AS h3,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 4) AS h4,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 5) AS h5,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 6) AS h6,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 7) AS h7,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 8) AS h8,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 9) AS h9,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 10) AS h10,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 11) AS h11,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 12) AS h12,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 13) AS h13,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 14) AS h14,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 15) AS h15,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 16) AS h16,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 17) AS h17,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 18) AS h18,
    ( SELECT sum(x.points) AS sum
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole < 10) AS f9,
    ( SELECT sum(x.points) AS sum
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole > 9) AS s9,
    sum(hs.points) AS points
   FROM scorecards s
     JOIN hole_scores hs ON hs.scorecard_id = s.id
     JOIN users u ON u.id = s.player_id
     JOIN courses c ON c.id = s.course_id
  GROUP BY s.id, u.full_name, c.course_name, c.id, c.tee, s.round_date
  ORDER BY s.tour_round, u.full_name;

------------------------------------------------------------------------------------------------


v_holes_scores:
select hs.hole_id, hs.scorecard_id, h.hole, hs.strokes, hs.points 
from holes h join hole_scores hs on h.id = hs.hole_id

v_tour_round_rank:
with a as (
select s.id as scorecard_id, s.player_id, s.tour_round, s.tour_id,
(select sum(points) from v_hole_scores hs where hs.scorecard_id = s.id ) as sum_18,
(select sum(points) from v_hole_scores hs where hs.scorecard_id = s.id  and hs.hole >8  ) as sum_s9,
(select sum(points) from v_hole_scores hs where hs.scorecard_id = s.id  and hs.hole >12  ) as sum_s6,
(select sum(points) from v_hole_scores hs where hs.scorecard_id = s.id  and hs.hole >15  ) as sum_s3,
(select sum(points) from v_hole_scores hs where hs.scorecard_id = s.id  and hs.hole >17  ) as sum_s1
from scorecards s
where  s.status = 'Submitted'
order by tour_round, player_id
)
select tour_id,tour_round, player_id, rank() over( PARTITION BY a.tour_round 
 ORDER BY
 a.sum_18, a.sum_s9, a.sum_s6, a.sum_s3, a.sum_s1) 
from a 


select 
player_id,
sum(rank)
from v_tour_round_rank
where tour_id = 1
group by player_id
---------------------------------------------------------------------------------------------------------------------------------------------------

ECLECTIC
 SELECT s.tour_id,
    s.player_id,
    u.full_name,
    h.hole,
    min(hs.strokes - h.par) AS eclectic
   FROM hole_scores hs
     JOIN holes h ON h.id = hs.hole_id
     JOIN scorecards s ON s.id = hs.scorecard_id
     JOIN users u ON s.player_id = u.id
  WHERE s.status = 'Submitted'::text
  GROUP BY s.player_id, h.hole, u.full_name, s.tour_id;


//ROUND
   SELECT s.id,
    u.full_name,
    c.course_name,
    s.handicap,
    s.tour_id,
    s.tour_round,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 1) AS h1,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 2) AS h2,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 3) AS h3,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 4) AS h4,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 5) AS h5,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 6) AS h6,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 7) AS h7,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 8) AS h8,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 9) AS h9,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 10) AS h10,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 11) AS h11,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 12) AS h12,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 13) AS h13,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 14) AS h14,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 15) AS h15,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 16) AS h16,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 17) AS h17,
    ( SELECT x.strokes
           FROM v_scorecards_scores x
          WHERE x.id = s.id AND x.hole = 18) AS h18,
    sum(hs.strokes) AS strokes,
    sum(hs.points) AS points
   FROM scorecards s
     JOIN hole_scores hs ON hs.scorecard_id = s.id
     JOIN users u ON u.id = s.player_id
     JOIN courses c ON c.id = s.course_id
  GROUP BY s.id, u.full_name, c.course_name
  ORDER BY s.tour_round, u.full_name;

//SUM
   SELECT s.player_id,
    s.tour_id,
    s.tour_round,
    sum(hs.strokes) AS strokes,
    sum(hs.points) AS points
   FROM scorecards s
     JOIN hole_scores hs ON hs.scorecard_id = s.id
  WHERE s.status = 'Submitted'::text
  GROUP BY s.id
  ORDER BY s.player_id;